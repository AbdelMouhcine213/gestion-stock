<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’³ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</title>

<style>
*{box-sizing:border-box}

body{
    margin:0;
    font-family:Arial;
    direction:rtl;
    background:linear-gradient(160deg,#050b18,#0a1f3f);
    color:white;
}

/* ===== Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ===== */
header{
    background:linear-gradient(90deg,#28a745,#20c997);
    padding:18px;
    text-align:center;
    font-size:28px;
    font-weight:bold;
    box-shadow:0 0 20px rgba(0,255,150,.6);
}

/* ===== Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ===== */
#categories{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    padding:10px;
    justify-content:center;
}

.cat-btn{
    background:#198754;
    border:none;
    color:white;
    padding:10px 18px;
    border-radius:20px;
    cursor:pointer;
    font-weight:bold;
}
.cat-btn:hover{
    background:#20c997;
}

/* ===== Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ===== */
#products{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
    gap:12px;
    padding:12px;
}

.product{
    background:#ffffff;
    color:#000;
    border-radius:16px;
    padding:8px;
    text-align:center;
    cursor:pointer;
    box-shadow:0 0 10px rgba(0,0,0,.3);
    transition:.2s;
}
.product:hover{
    transform:scale(1.05);
}

.product img{
    width:100%;
    height:120px;
    object-fit:contain;
}

.product span{
    display:block;
    font-size:14px;
    margin-top:4px;
}

/* ===== Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¨ÙŠØ¹ ===== */
#saleBox{
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    background:#08152a;
    border-top:3px solid #20c997;
    padding:10px;
}

.sale-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
    gap:8px;
}

input{
    padding:10px;
    border-radius:10px;
    border:none;
    font-size:16px;
}

button.sell{
    background:#ffc107;
    border:none;
    font-size:18px;
    font-weight:bold;
    border-radius:12px;
    cursor:pointer;
}
</style>
</head>

<body>

<header>ğŸ’³ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</header>

<!-- Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª -->
<div id="categories"></div>

<!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
<div id="products"></div>

<!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¨ÙŠØ¹ -->
<div id="saleBox">
    <div class="sale-grid">
        <input id="pname" placeholder="Ø§Ù„Ù…Ù†ØªØ¬" disabled>
        <input id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±" disabled>
        <input id="qty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" value="1">
        <input id="total" placeholder="Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹" disabled>
        <button class="sell" onclick="sell()">âœ” Ø¨ÙŠØ¹</button>
    </div>
</div>

<script>
let stock = JSON.parse(localStorage.getItem("stock")) || [];
let selectedProduct=null;

const catsDiv=document.getElementById("categories");
const productsDiv=document.getElementById("products");

const pname=document.getElementById("pname");
const price=document.getElementById("price");
const qty=document.getElementById("qty");
const total=document.getElementById("total");

/* ===== Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ===== */
function renderCategories(){
    const cats=[...new Set(stock.map(p=>p.category))];
    catsDiv.innerHTML="";
    cats.forEach(c=>{
        let b=document.createElement("button");
        b.className="cat-btn";
        b.textContent=c;
        b.onclick=()=>showCategory(c);
        catsDiv.appendChild(b);
    });
}

/* ===== Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ===== */
function showCategory(cat){
    productsDiv.innerHTML="";
    stock.filter(p=>p.category===cat && p.qtyLeft>0)
    .forEach(p=>{
        let d=document.createElement("div");
        d.className="product";
        d.innerHTML=`
            <img src="${p.image}">
            <span>${p.name}</span>
            <span>${p.sell} Ø¯Ø¬</span>
        `;
        d.onclick=()=>{
            selectedProduct=p;
            pname.value=p.name;
            price.value=p.sell;
            qty.value=1;
            calc();
        };
        productsDiv.appendChild(d);
    });
}

/* ===== Ø­Ø³Ø§Ø¨ ===== */
function calc(){
    total.value = price.value * qty.value;
}
qty.oninput=calc;

/* ===== Ø¨ÙŠØ¹ ===== */
function sell(){
    if(!selectedProduct) return alert("Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ù‹Ø§");

    if(qty.value>selectedProduct.qtyLeft){
        alert("Ø§Ù„ÙƒÙ…ÙŠØ© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©");
        return;
    }

    selectedProduct.qtyLeft -= Number(qty.value);
    localStorage.setItem("stock",JSON.stringify(stock));

    pname.value=price.value=qty.value=total.value="";
    selectedProduct=null;
    productsDiv.innerHTML="";
    alert("âœ… ØªÙ… Ø§Ù„Ø¨ÙŠØ¹");
}

renderCategories();
</script>

</body>
</html>
