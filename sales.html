<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ğŸ›’ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - ÙˆØ§Ø¬Ù‡Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
<style>
*{box-sizing:border-box;}
body{
    font-family:'Comic Sans MS', Arial;
    direction:rtl;
    background:linear-gradient(160deg,#050b18,#0a1f3f);
    color:white;
    margin:0;
    display:flex;
    justify-content:center;
    padding:20px;
}
header{
    width:100%;
    background:linear-gradient(90deg,#28a745,#20c997);
    padding:20px;
    text-align:center;
    font-size:32px;
    font-weight:bold;
    box-shadow:0 0 35px rgba(40,167,69,.8), inset 0 0 15px rgba(0,255,150,.3);
    border-radius:15px;
    margin-bottom:20px;
}
.container{
    max-width:1200px;
    width:100%;
}
.card{
    background:rgba(15,27,46,.95);
    border-radius:25px;
    padding:25px;
    margin-bottom:20px;
    border:2px solid rgba(0,255,150,.3);
    box-shadow:0 0 30px rgba(0,255,150,.4), inset 0 0 25px rgba(0,255,150,.15);
}
.flex{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:20px;
}
input{
    width:100%;
    padding:12px;
    font-size:16px;
    border-radius:12px;
    border:1px solid #00ff99;
    background:rgba(8,21,42,.9);
    color:#00ffcc;
    outline:none;
}
input:focus{
    box-shadow:0 0 15px #00ff99, inset 0 0 10px #00ff99;
}
.btn{
    padding:14px;
    font-size:18px;
    border:none;
    border-radius:14px;
    cursor:pointer;
    width:100%;
    font-weight:bold;
    transition:.25s;
}
.scan{ background:linear-gradient(45deg,#ffc107,#ff9800); color:black; }
.add{ background:linear-gradient(45deg,#17a2b8,#0dcaf0); color:white; }
.confirm{ background:linear-gradient(45deg,#28a745,#20c997); color:white; }
.delete{ background:#dc3545; color:white; border:none; padding:6px 12px; border-radius:10px; cursor:pointer; }
.cart-total{ font-size:28px; font-weight:bold; color:#ff0; text-align:right; margin-top:10px; }
.product-img{ width:100%; border-radius:15px; cursor:pointer; transition:.25s; }
.product-img:hover{ transform:scale(1.05); box-shadow:0 0 15px #0ff; }
table{ width:100%; border-collapse:collapse; background:#050e1f; border-radius:15px; overflow:hidden; font-size:16px; margin-top:15px; }
th{ background:linear-gradient(90deg,#28a745,#20c997); padding:12px; text-align:center; }
td{ padding:10px; border-bottom:1px solid #123; text-align:center; }
tr:hover{ background:rgba(0,255,150,.1); }
@media(max-width:600px){ header{ font-size:24px; } }
</style>
</head>
<body>

<header>ğŸ›’ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</header>

<div class="container">

    <!-- ===== Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø§Ù„ØµÙˆØ± ===== -->
    <div class="card" id="productList">
        <div class="flex" id="productGrid">
            <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ± Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
        </div>
    </div>

    <!-- ===== Ø§Ù„Ø³Ù„Ø© ===== -->
    <div class="card">
        <h2>ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
        <table>
        <thead>
        <tr>
            <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
            <th>Ø§Ù„Ø³Ø¹Ø±</th>
            <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>
            <th>ØªØ¹Ø¯ÙŠÙ„</th>
            <th>Ø­Ø°Ù</th>
        </tr>
        </thead>
        <tbody id="cartBody"></tbody>
        </table>
        <div class="cart-total">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="cartTotal">0</span> Ø¯Ø¬</div>
        <button class="btn confirm" onclick="confirmSale()">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨ÙŠØ¹</button>
        <button class="btn save" onclick="showStats()">ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
    </div>

</div>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† (Ù†Ù…Ø§Ø°Ø¬)
let stock = JSON.parse(localStorage.getItem("stock")) || [
    {name:"Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©", sell:300, buy:200, qtyLeft:50, img:"choco.jpg"},
    {name:"Ø¹Ø·Ø± Ø±Ø¬Ø§Ù„ÙŠ", sell:1200, buy:900, qtyLeft:30, img:"perfume.jpg"},
    {name:"Ø­Ù„ÙˆÙŠØ§Øª", sell:150, buy:100, qtyLeft:100, img:"candy.jpg"}
];
let cart = [];
let sales = JSON.parse(localStorage.getItem("sales")) || [];

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø§Ù„ØµÙˆØ±
function renderProducts(){
    const grid = document.getElementById("productGrid");
    grid.innerHTML="";
    stock.forEach((p,i)=>{
        if(p.qtyLeft>0){
            let div = document.createElement("div");
            div.innerHTML=`<img src="${p.img}" class="product-img" onclick="addToCart(${i})"><p>${p.name}<br>(${p.qtyLeft})</p>`;
            grid.appendChild(div);
        }
    });
}
renderProducts();

// Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
function addToCart(i){
    let p = stock[i];
    let existing = cart.find(c=>c.name===p.name);
    if(existing){
        existing.qty++;
    } else {
        cart.push({name:p.name, price:p.sell, qty:1});
    }
    renderCart();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©
function renderCart(){
    const tbody = document.getElementById("cartBody");
    let total=0;
    tbody.innerHTML="";
    cart.forEach((c,i)=>{
        let tr = document.createElement("tr");
        let sum = c.price*c.qty;
        total+=sum;
        tr.innerHTML=`
<td>${c.name}</td>
<td>${c.price}</td>
<td><input type="number" value="${c.qty}" min="1" style="width:60px" onchange="changeQty(${i},this.value)"></td>
<td>${sum}</td>
<td><button class="btn add" onclick="changeName(${i})">âœï¸</button></td>
<td><button class="delete" onclick="removeItem(${i})">ğŸ—‘ï¸</button></td>
        `;
        tbody.appendChild(tr);
    });
    document.getElementById("cartTotal").textContent=total;
}

// ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ©
function changeQty(i,val){
    cart[i].qty = Number(val);
    renderCart();
}

// ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…
function changeName(i){
    let newName = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯", cart[i].name);
    if(newName) cart[i].name=newName;
    renderCart();
}

// Ø­Ø°Ù Ø¹Ù†ØµØ±
function removeItem(i){
    cart.splice(i,1);
    renderCart();
}

// ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨ÙŠØ¹
function confirmSale(){
    if(cart.length===0){ alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„Ø³Ù„Ø©"); return; }
    let today = new Date();
    let dateStr = today.toISOString().split('T')[0];
    cart.forEach(item=>{
        let s = stock.find(p=>p.name===item.name);
        if(s) s.qtyLeft -= item.qty;
        let profit = (item.price - (s?s.buy:0))*item.qty;
        sales.push({name:item.name, qty:item.qty, price:item.price, total:item.price*item.qty, profit:profit, date:dateStr});
    });
    localStorage.setItem("stock", JSON.stringify(stock));
    localStorage.setItem("sales", JSON.stringify(sales));
    cart=[];
    renderCart();
    renderProducts();
    alert("âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨ÙŠØ¹ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø²ÙˆÙ†");
}

// Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª
function profitStats(){
    let daily={}, monthly={};
    sales.forEach(s=>{
        let d = s.date;
        let m = d.slice(0,7);
        daily[d]=(daily[d]||0)+s.profit;
        monthly[m]=(monthly[m]||0)+s.profit;
    });
    return {daily,monthly};
}
function showStats(){
    let stats = profitStats();
    let msg="ğŸ“… Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ:\n";
    for(let d in stats.daily) msg+=`${d}: ${stats.daily[d]} Ø¯Ø¬\n`;
    msg+="\nğŸ“… Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ:\n";
    for(let m in stats.monthly) msg+=`${m}: ${stats.monthly[m]} Ø¯Ø¬\n`;
    alert(msg);
}
</script>

</body>
</html>
