<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#28a745">

<script src="https://unpkg.com/@zxing/library@latest"></script>

<style>
*{box-sizing:border-box;}
body{
    font-family:'Comic Sans MS', Arial;
    direction:rtl;
    background:linear-gradient(160deg,#050b18,#0a1f3f);
    color:white;
    margin:0;
    padding:15px;
}

header{
    text-align:center;
    font-size:34px;
    font-weight:bold;
    padding:18px;
    border-radius:18px;
    background:linear-gradient(90deg,#28a745,#20c997);
    box-shadow:0 0 35px rgba(40,255,150,.8);
    margin-bottom:15px;
}

.container{max-width:1100px;margin:auto;}

.card{
    background:rgba(15,27,46,.96);
    border-radius:22px;
    padding:20px;
    margin-bottom:18px;
    border:2px solid rgba(0,255,150,.35);
    box-shadow:0 0 28px rgba(0,255,150,.45);
}

button{
    width:100%;
    padding:16px;
    font-size:20px;
    border:none;
    border-radius:18px;
    font-weight:bold;
    cursor:pointer;
}

.scan{
    background:linear-gradient(45deg,#ffc107,#ff9800);
    margin-bottom:12px;
}

video{
    width:100%;
    height:260px;
    object-fit:cover;
    border-radius:18px;
    display:none;
    border:3px solid #00ffff;
    box-shadow:0 0 25px #00ffff;
}

/* ØªÙƒØ¨ÙŠØ± Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (Ø¥Ø­Ø³Ø§Ø³ Landscape) */
.video-landscape{
    aspect-ratio: 16 / 9;
}

.flex{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
    gap:15px;
}

input{
    width:100%;
    padding:14px;
    font-size:18px;
    border-radius:14px;
    border:1px solid #00ff99;
    background:#08152a;
    color:#00ffcc;
}

table{
    width:100%;
    border-collapse:collapse;
    background:#050e1f;
}
th{
    background:linear-gradient(90deg,#28a745,#20c997);
    padding:10px;
}
td{
    padding:8px;
    text-align:center;
}

.save{
    background:linear-gradient(45deg,#28a745,#20c997);
    margin-top:10px;
}
</style>
</head>

<body>

<header>ğŸ›’ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</header>

<div class="container">

<!-- Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù…Ø¨Ø§Ø´Ø±Ø© ØªØ­Øª Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
<div class="card">

<button class="scan" onclick="startScanner()">ğŸ“· ÙØªØ­ Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯</button>

<video id="camera" class="video-landscape" playsinline></video>

</div>

<div class="card">
<div class="flex">

<input id="barcode" placeholder="ğŸ“¦ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (13 Ø±Ù‚Ù…)">
<input id="productSearch" placeholder="ğŸ§¾ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
<input id="buyPrice" placeholder="ğŸ’° Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡">
<input id="sellPrice" placeholder="ğŸ’µ Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
<input id="qty" type="number" placeholder="ğŸ“¦ Ø§Ù„ÙƒÙ…ÙŠØ©">
<input id="purchaseDate" type="date">
<input id="expiryDate" type="date">

<button onclick="addPurchase()" style="background:#17a2b8;color:white;">â• Ø¥Ø¶Ø§ÙØ©</button>

</div>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Ø§Ù„Ø´Ø±Ø§Ø¡</th>
<th>Ø§Ù„Ù…Ù†ØªØ¬</th>
<th>Ø´Ø±Ø§Ø¡</th>
<th>Ø¨ÙŠØ¹</th>
<th>ÙƒÙ…ÙŠØ©</th>
<th>ØµÙ„Ø§Ø­ÙŠØ©</th>
<th>Ø­Ø°Ù</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<button class="save" onclick="savePurchases()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</button>
</div>

</div>

<audio id="beep" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
let codeReader;
let scanning=false;

const video=document.getElementById("camera");
const beep=document.getElementById("beep");

async function startScanner(){
    if(scanning) return;
    scanning=true;

    video.style.display="block";

    codeReader=new ZXing.BrowserMultiFormatReader();

    const devices=await codeReader.listVideoInputDevices();
    const backCam=devices.find(d=>d.label.toLowerCase().includes("back"))||devices[0];

    codeReader.decodeFromVideoDevice(
        backCam.deviceId,
        video,
        (result,err)=>{
            if(result){
                const code=result.text;

                // ØªØ«Ø¨ÙŠØª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· + 13 Ø±Ù‚Ù…
                if(/^\d{13}$/.test(code)){
                    document.getElementById("barcode").value=code;
                    beep.play();
                    stopScanner();
                }
            }
        }
    );
}

function stopScanner(){
    scanning=false;
    if(codeReader) codeReader.reset();
    video.style.display="none";
}

/* Ù…Ù†Ø·Ù‚Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ */
function addPurchase(){ }
function savePurchases(){ }
</script>

</body>
</html>
